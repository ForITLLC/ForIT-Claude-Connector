{
  "swagger": "2.0",
  "info": {
    "title": "ForIT Claude Connector",
    "description": "Power Automate connector for Anthropic's Claude API.",
    "version": "2.6.0",
    "contact": {
      "name": "ForIT Support",
      "url": "https://github.com/ForITLLC/ForIT-Claude-Connector"
    },
    "x-ms-api-annotation": {
      "status": "Production"
    }
  },
  "host": "api.anthropic.com",
  "basePath": "/v1",
  "schemes": ["https"],
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "securityDefinitions": {
    "api_key": {
      "type": "apiKey",
      "name": "x-api-key",
      "in": "header",
      "description": "Anthropic API Key"
    }
  },
  "security": [{ "api_key": [] }],
  "paths": {
    "/messages": {
      "post": {
        "operationId": "AskClaude",
        "summary": "Ask Claude",
        "description": "Simple prompt to Claude 4.5. For advanced options, use Create a Message (Advanced).",
        "x-ms-visibility": "important",
        "x-ms-api-annotation": {
          "family": "AskClaude",
          "revision": 1
        },
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["model", "max_tokens", "prompt"],
              "properties": {
                "model": {
                  "type": "string",
                  "description": "Claude 4.5 model",
                  "enum": ["claude-sonnet-4-5-20250929", "claude-opus-4-5-20251101"],
                  "default": "claude-sonnet-4-5-20250929",
                  "x-ms-summary": "Model"
                },
                "max_tokens": {
                  "type": "integer",
                  "default": 4096,
                  "x-ms-visibility": "internal"
                },
                "prompt": {
                  "type": "string",
                  "description": "Your question for Claude",
                  "x-ms-summary": "Prompt"
                },
                "system": {
                  "type": "string",
                  "description": "Leave empty for text, or set for JSON",
                  "x-ms-summary": "Output Format",
                  "enum": ["", "Respond only with valid JSON."],
                  "default": "",
                  "x-ms-visibility": "advanced"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "response": { "type": "string", "x-ms-summary": "Response" },
                "id": { "type": "string", "x-ms-summary": "Message ID", "x-ms-visibility": "advanced" },
                "model": { "type": "string", "x-ms-summary": "Model", "x-ms-visibility": "advanced" },
                "stop_reason": { "type": "string", "x-ms-summary": "Stop Reason", "x-ms-visibility": "advanced" },
                "usage": {
                  "type": "object",
                  "x-ms-summary": "Usage",
                  "x-ms-visibility": "advanced",
                  "properties": {
                    "input_tokens": { "type": "integer", "x-ms-summary": "Input Tokens" },
                    "output_tokens": { "type": "integer", "x-ms-summary": "Output Tokens" }
                  }
                }
              }
            }
          },
          "400": { "description": "Bad request", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "401": { "description": "Invalid API key", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "429": { "description": "Rate limited", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "500": { "description": "Server error", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      }
    },
    "/messages?thinking": {
      "post": {
        "operationId": "AskClaudeWithThinking",
        "summary": "Ask Claude with Thinking",
        "description": "Claude reasons through the problem before responding. Best for complex tasks.",
        "x-ms-visibility": "important",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["model", "max_tokens", "prompt", "thinking"],
              "properties": {
                "model": {
                  "type": "string",
                  "description": "Claude 4.5 model",
                  "enum": ["claude-sonnet-4-5-20250929", "claude-opus-4-5-20251101"],
                  "default": "claude-sonnet-4-5-20250929",
                  "x-ms-summary": "Model"
                },
                "max_tokens": {
                  "type": "integer",
                  "default": 16000,
                  "x-ms-visibility": "internal"
                },
                "prompt": {
                  "type": "string",
                  "description": "Your question for Claude",
                  "x-ms-summary": "Prompt"
                },
                "thinking": {
                  "type": "object",
                  "required": ["type", "budget_tokens"],
                  "properties": {
                    "type": {
                      "type": "string",
                      "default": "enabled",
                      "x-ms-visibility": "internal"
                    },
                    "budget_tokens": {
                      "type": "integer",
                      "description": "Token budget for reasoning (10000-128000)",
                      "x-ms-summary": "Thinking Budget",
                      "default": 10000,
                      "minimum": 1024,
                      "maximum": 128000
                    }
                  }
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "response": { "type": "string", "x-ms-summary": "Response" },
                "thinking_output": { "type": "string", "x-ms-summary": "Thinking" },
                "id": { "type": "string", "x-ms-summary": "Message ID", "x-ms-visibility": "advanced" },
                "model": { "type": "string", "x-ms-summary": "Model", "x-ms-visibility": "advanced" },
                "stop_reason": { "type": "string", "x-ms-summary": "Stop Reason", "x-ms-visibility": "advanced" },
                "usage": {
                  "type": "object",
                  "x-ms-summary": "Usage",
                  "x-ms-visibility": "advanced",
                  "properties": {
                    "input_tokens": { "type": "integer", "x-ms-summary": "Input Tokens" },
                    "output_tokens": { "type": "integer", "x-ms-summary": "Output Tokens" }
                  }
                }
              }
            }
          },
          "400": { "description": "Bad request", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "401": { "description": "Invalid API key", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "429": { "description": "Rate limited", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "500": { "description": "Server error", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      }
    },
    "/messages/": {
      "post": {
        "operationId": "CreateMessage",
        "summary": "Create a Message (Advanced)",
        "description": "Full control over Claude API with system prompts, temperature, and all parameters.",
        "x-ms-visibility": "advanced",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["model", "max_tokens", "messages"],
              "properties": {
                "model": {
                  "type": "string",
                  "description": "Claude 4.5 Opus",
                  "enum": ["claude-sonnet-4-5-20250929", "claude-opus-4-5-20251101"],
                  "default": "claude-sonnet-4-5-20250929",
                  "x-ms-summary": "Model"
                },
                "messages": {
                  "type": "array",
                  "description": "Conversation messages",
                  "x-ms-summary": "Messages",
                  "items": {
                    "type": "object",
                    "required": ["role", "content"],
                    "properties": {
                      "role": { "type": "string", "enum": ["user", "assistant"], "default": "user", "x-ms-summary": "Role" },
                      "content": { "type": "string", "x-ms-summary": "Content" }
                    }
                  }
                },
                "max_tokens": { "type": "integer", "default": 1024, "minimum": 1, "maximum": 4096, "x-ms-summary": "Max Tokens" },
                "system": { "type": "string", "description": "System prompt", "x-ms-summary": "System Prompt" },
                "temperature": { "type": "number", "minimum": 0, "maximum": 1, "x-ms-summary": "Temperature" },
                "top_p": { "type": "number", "minimum": 0, "maximum": 1, "x-ms-summary": "Top P" },
                "top_k": { "type": "integer", "minimum": 1, "x-ms-summary": "Top K" },
                "stop_sequences": { "type": "array", "x-ms-summary": "Stop Sequences", "items": { "type": "string" } }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "x-ms-summary": "Message ID" },
                "type": { "type": "string", "x-ms-summary": "Response Type" },
                "role": { "type": "string", "x-ms-summary": "Role" },
                "content": {
                  "type": "array",
                  "x-ms-summary": "Response Content",
                  "items": {
                    "type": "object",
                    "properties": {
                      "type": { "type": "string", "x-ms-summary": "Content Type" },
                      "text": { "type": "string", "x-ms-summary": "Response Text" }
                    }
                  }
                },
                "model": { "type": "string", "x-ms-summary": "Model Used" },
                "stop_reason": { "type": "string", "x-ms-summary": "Stop Reason" },
                "stop_sequence": { "type": "string", "x-ms-summary": "Stop Sequence" },
                "usage": {
                  "type": "object",
                  "x-ms-summary": "Token Usage",
                  "properties": {
                    "input_tokens": { "type": "integer", "x-ms-summary": "Input Tokens" },
                    "output_tokens": { "type": "integer", "x-ms-summary": "Output Tokens" }
                  }
                }
              }
            }
          },
          "400": { "description": "Bad request", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "401": { "description": "Invalid API key", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "429": { "description": "Rate limited", "schema": { "$ref": "#/definitions/ErrorResponse" } },
          "500": { "description": "Server error", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      }
    },
    "/messages/count_tokens": {
      "post": {
        "operationId": "CountTokens",
        "summary": "Count Tokens",
        "description": "Count tokens before sending to estimate costs.",
        "x-ms-visibility": "advanced",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["model", "messages"],
              "properties": {
                "model": { "type": "string", "enum": ["claude-sonnet-4-5-20250929", "claude-opus-4-5-20251101"], "default": "claude-sonnet-4-5-20250929", "x-ms-summary": "Model" },
                "messages": {
                  "type": "array",
                  "x-ms-summary": "Messages",
                  "items": {
                    "type": "object",
                    "properties": {
                      "role": { "type": "string", "enum": ["user", "assistant"] },
                      "content": { "type": "string" }
                    }
                  }
                },
                "system": { "type": "string", "x-ms-summary": "System Prompt" }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "input_tokens": { "type": "integer", "x-ms-summary": "Token Count" }
              }
            }
          },
          "400": { "description": "Bad request", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      }
    },
    "/messages/batches": {
      "post": {
        "operationId": "CreateMessageBatch",
        "summary": "Create Message Batch (Advanced)",
        "description": "Create a batch of messages for async processing.",
        "x-ms-visibility": "advanced",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "anthropic-beta",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "message-batches-2024-09-24",
            "x-ms-visibility": "internal"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["requests"],
              "properties": {
                "requests": {
                  "type": "array",
                  "x-ms-summary": "Batch Requests",
                  "items": {
                    "type": "object",
                    "required": ["custom_id", "params"],
                    "properties": {
                      "custom_id": { "type": "string", "x-ms-summary": "Custom ID" },
                      "params": {
                        "type": "object",
                        "x-ms-summary": "Request Parameters",
                        "properties": {
                          "model": { "type": "string", "enum": ["claude-sonnet-4-5-20250929", "claude-opus-4-5-20251101"], "default": "claude-sonnet-4-5-20250929", "x-ms-summary": "Model" },
                          "max_tokens": { "type": "integer", "default": 1024, "x-ms-summary": "Max Tokens" },
                          "messages": {
                            "type": "array",
                            "x-ms-summary": "Messages",
                            "items": {
                              "type": "object",
                              "properties": {
                                "role": { "type": "string", "enum": ["user", "assistant"] },
                                "content": { "type": "string" }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "x-ms-summary": "Batch ID" },
                "type": { "type": "string", "x-ms-summary": "Type" },
                "processing_status": { "type": "string", "x-ms-summary": "Processing Status" },
                "request_counts": {
                  "type": "object",
                  "x-ms-summary": "Request Counts",
                  "properties": {
                    "processing": { "type": "integer", "x-ms-summary": "Processing" },
                    "succeeded": { "type": "integer", "x-ms-summary": "Succeeded" },
                    "errored": { "type": "integer", "x-ms-summary": "Errored" },
                    "canceled": { "type": "integer", "x-ms-summary": "Canceled" },
                    "expired": { "type": "integer", "x-ms-summary": "Expired" }
                  }
                },
                "created_at": { "type": "string", "x-ms-summary": "Created At" },
                "expires_at": { "type": "string", "x-ms-summary": "Expires At" }
              }
            }
          },
          "400": { "description": "Bad request", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      },
      "get": {
        "operationId": "ListMessageBatches",
        "summary": "List Message Batches (Advanced)",
        "description": "List all message batches.",
        "x-ms-visibility": "advanced",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "anthropic-beta",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "message-batches-2024-09-24",
            "x-ms-visibility": "internal"
          },
          {
            "name": "limit",
            "in": "query",
            "type": "integer",
            "default": 20,
            "x-ms-summary": "Limit"
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "array",
                  "x-ms-summary": "Batches",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": { "type": "string", "x-ms-summary": "Batch ID" },
                      "processing_status": { "type": "string", "x-ms-summary": "Status" },
                      "created_at": { "type": "string", "x-ms-summary": "Created At" }
                    }
                  }
                },
                "has_more": { "type": "boolean", "x-ms-summary": "Has More" }
              }
            }
          }
        }
      }
    },
    "/messages/batches/{batch_id}": {
      "get": {
        "operationId": "GetMessageBatch",
        "summary": "Get Message Batch (Advanced)",
        "description": "Get details of a specific message batch.",
        "x-ms-visibility": "advanced",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "anthropic-beta",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "message-batches-2024-09-24",
            "x-ms-visibility": "internal"
          },
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "type": "string",
            "x-ms-summary": "Batch ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "x-ms-summary": "Batch ID" },
                "type": { "type": "string", "x-ms-summary": "Type" },
                "processing_status": { "type": "string", "x-ms-summary": "Processing Status" },
                "request_counts": {
                  "type": "object",
                  "x-ms-summary": "Request Counts",
                  "properties": {
                    "processing": { "type": "integer", "x-ms-summary": "Processing" },
                    "succeeded": { "type": "integer", "x-ms-summary": "Succeeded" },
                    "errored": { "type": "integer", "x-ms-summary": "Errored" },
                    "canceled": { "type": "integer", "x-ms-summary": "Canceled" },
                    "expired": { "type": "integer", "x-ms-summary": "Expired" }
                  }
                },
                "created_at": { "type": "string", "x-ms-summary": "Created At" },
                "ended_at": { "type": "string", "x-ms-summary": "Ended At" },
                "expires_at": { "type": "string", "x-ms-summary": "Expires At" },
                "results_url": { "type": "string", "x-ms-summary": "Results URL" }
              }
            }
          },
          "404": { "description": "Not found", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      }
    },
    "/messages/batches/{batch_id}/cancel": {
      "post": {
        "operationId": "CancelMessageBatch",
        "summary": "Cancel Message Batch (Advanced)",
        "description": "Cancel a message batch that is in progress.",
        "x-ms-visibility": "advanced",
        "parameters": [
          {
            "name": "anthropic-version",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "2023-06-01",
            "x-ms-visibility": "internal"
          },
          {
            "name": "anthropic-beta",
            "in": "header",
            "required": true,
            "type": "string",
            "default": "message-batches-2024-09-24",
            "x-ms-visibility": "internal"
          },
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "type": "string",
            "x-ms-summary": "Batch ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "x-ms-summary": "Batch ID" },
                "type": { "type": "string", "x-ms-summary": "Type" },
                "processing_status": { "type": "string", "x-ms-summary": "Processing Status" }
              }
            }
          },
          "404": { "description": "Not found", "schema": { "$ref": "#/definitions/ErrorResponse" } }
        }
      }
    }
  },
  "definitions": {
    "ErrorResponse": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "x-ms-summary": "Error Type" },
        "error": {
          "type": "object",
          "properties": {
            "type": { "type": "string", "x-ms-summary": "Error Category" },
            "message": { "type": "string", "x-ms-summary": "Error Message" }
          }
        }
      }
    }
  },
  "x-ms-connector-metadata": [
    { "propertyName": "Website", "propertyValue": "https://www.anthropic.com" },
    { "propertyName": "Privacy policy", "propertyValue": "https://www.anthropic.com/privacy" },
    { "propertyName": "Categories", "propertyValue": "AI;Productivity" }
  ]
}
